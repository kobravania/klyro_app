<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klyro - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø–∏—Ç–∞–Ω–∏—é</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div id="app">
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loading-screen" class="screen active">
            <div class="logo-container">
                <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#5DADE2" stroke-width="3"/>
                    <path d="M 30 30 L 50 50 L 70 30 M 50 50 L 50 70" stroke="#5DADE2" stroke-width="4" stroke-linecap="round" fill="none"/>
                    <circle cx="50" cy="50" r="8" fill="#82E0AA"/>
                </svg>
                <h1 class="app-title">Klyro</h1>
            </div>
        </div>

        <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω / –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
        <div id="auth-screen" class="screen">
            <div class="container">
                <div class="logo-container-small">
                    <svg class="logo-small" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="45" fill="none" stroke="#5DADE2" stroke-width="3"/>
                        <path d="M 30 30 L 50 50 L 70 30 M 50 50 L 50 70" stroke="#5DADE2" stroke-width="4" stroke-linecap="round" fill="none"/>
                        <circle cx="50" cy="50" r="8" fill="#82E0AA"/>
                    </svg>
                </div>
                <h2 class="screen-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Klyro</h2>
                <p class="screen-subtitle">–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø–∏—Ç–∞–Ω–∏—é –∏ —Ñ–∏—Ç–Ω–µ—Å—É</p>
                <button id="auth-button" class="btn btn-primary">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram</button>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ -->
        <div id="onboarding-screen" class="screen">
            <div class="container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                
                <!-- –®–∞–≥ 1: –í–æ–∑—Ä–∞—Å—Ç –∏ –ø–æ–ª -->
                <div class="onboarding-step active" data-step="1">
                    <h2 class="screen-title">–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ</h2>
                    <div class="form-group">
                        <label for="age">–í–æ–∑—Ä–∞—Å—Ç</label>
                        <input type="number" id="age" min="10" max="120" placeholder="25" class="input">
                    </div>
                    <div class="form-group">
                        <label>–ü–æ–ª</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="gender" value="male" class="radio-input">
                                <span class="radio-custom">–ú—É–∂—Å–∫–æ–π</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="gender" value="female" class="radio-input">
                                <span class="radio-custom">–ñ–µ–Ω—Å–∫–∏–π</span>
                            </label>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-next" onclick="nextStep()">–î–∞–ª–µ–µ</button>
                </div>

                <!-- –®–∞–≥ 2: –†–æ—Å—Ç –∏ –≤–µ—Å -->
                <div class="onboarding-step" data-step="2">
                    <h2 class="screen-title">–§–∏–∑–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
                    <div class="form-group">
                        <label for="height">–†–æ—Å—Ç (—Å–º)</label>
                        <input type="number" id="height" min="100" max="250" placeholder="175" class="input">
                    </div>
                    <div class="form-group">
                        <label for="weight">–í–µ—Å (–∫–≥)</label>
                        <input type="number" id="weight" min="30" max="300" step="0.1" placeholder="70" class="input">
                    </div>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
                        <button class="btn btn-primary btn-next" onclick="nextStep()">–î–∞–ª–µ–µ</button>
                    </div>
                </div>

                <!-- –®–∞–≥ 3: –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
                <div class="onboarding-step" data-step="3">
                    <h2 class="screen-title">–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h2>
                    <div class="form-group">
                        <div class="option-cards">
                            <label class="option-card">
                                <input type="radio" name="activity" value="low" class="radio-input">
                                <div class="card-content">
                                    <div class="card-icon">üèÉ</div>
                                    <div class="card-title">–ù–∏–∑–∫–∏–π</div>
                                    <div class="card-desc">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏</div>
                                </div>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="activity" value="moderate" class="radio-input">
                                <div class="card-content">
                                    <div class="card-icon">üèãÔ∏è</div>
                                    <div class="card-title">–°—Ä–µ–¥–Ω–∏–π</div>
                                    <div class="card-desc">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ 3-4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é</div>
                                </div>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="activity" value="high" class="radio-input">
                                <div class="card-content">
                                    <div class="card-icon">üí™</div>
                                    <div class="card-title">–í—ã—Å–æ–∫–∏–π</div>
                                    <div class="card-desc">–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ 5+ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é</div>
                                </div>
                            </label>
                        </div>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
                        <button class="btn btn-primary btn-next" onclick="nextStep()">–î–∞–ª–µ–µ</button>
                    </div>
                </div>

                <!-- –®–∞–≥ 4: –¶–µ–ª—å -->
                <div class="onboarding-step" data-step="4">
                    <h2 class="screen-title">–í–∞—à–∞ —Ü–µ–ª—å</h2>
                    <div class="form-group">
                        <div class="option-cards">
                            <label class="option-card">
                                <input type="radio" name="goal" value="lose" class="radio-input">
                                <div class="card-content">
                                    <div class="card-icon">üìâ</div>
                                    <div class="card-title">–°–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Å–∞</div>
                                    <div class="card-desc">–°–æ–∑–¥–∞—Ç—å –¥–µ—Ñ–∏—Ü–∏—Ç –∫–∞–ª–æ—Ä–∏–π</div>
                                </div>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="goal" value="maintain" class="radio-input">
                                <div class="card-content">
                                    <div class="card-icon">‚öñÔ∏è</div>
                                    <div class="card-title">–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–µ—Å–∞</div>
                                    <div class="card-desc">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –≤–µ—Å</div>
                                </div>
                            </label>
                            <label class="option-card">
                                <input type="radio" name="goal" value="gain" class="radio-input">
                                <div class="card-content">
                                    <div class="card-icon">üìà</div>
                                    <div class="card-title">–ù–∞–±–æ—Ä –º–∞—Å—Å—ã</div>
                                    <div class="card-desc">–£–≤–µ–ª–∏—á–∏—Ç—å –º—ã—à–µ—á–Ω—É—é –º–∞—Å—Å—É</div>
                                </div>
                            </label>
                        </div>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
                        <button class="btn btn-primary btn-next" onclick="completeOnboarding()">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile-screen" class="screen">
            <div class="container">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <img id="user-avatar" src="" alt="Avatar" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="avatar-placeholder" style="display: none;">
                            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="50" cy="50" r="45" fill="#5DADE2" opacity="0.2"/>
                                <circle cx="50" cy="35" r="15" fill="#5DADE2"/>
                                <path d="M 20 80 Q 20 60 50 60 Q 80 60 80 80" fill="#5DADE2"/>
                            </svg>
                        </div>
                    </div>
                    <h2 id="user-name" class="profile-name"></h2>
                </div>

                <div class="stats-card">
                    <div class="stat-item">
                        <div class="stat-label">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–∞–ª–æ—Ä–∏–∏</div>
                        <div class="stat-value" id="calories-value">0</div>
                        <div class="stat-unit">–∫–∫–∞–ª/–¥–µ–Ω—å</div>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-row">
                        <span class="info-label">–í–æ–∑—Ä–∞—Å—Ç</span>
                        <span class="info-value" id="profile-age">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ü–æ–ª</span>
                        <span class="info-value" id="profile-gender">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–†–æ—Å—Ç</span>
                        <span class="info-value" id="profile-height">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–í–µ—Å</span>
                        <span class="info-value" id="profile-weight">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</span>
                        <span class="info-value" id="profile-activity">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–¶–µ–ª—å</span>
                        <span class="info-value" id="profile-goal">-</span>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-icon" onclick="editProfile()" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="btn btn-icon" onclick="recalculateCalories()" title="–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M1 4v6h6"></path>
                            <path d="M23 20v-6h-6"></path>
                            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                        </svg>
                        –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞
        window.addEventListener('load', function() {
            console.log('Window loaded, checking state...');
            setTimeout(function() {
                var loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen && loadingScreen.classList.contains('active')) {
                    console.warn('Loading screen still active after page load, forcing transition');
                    if (typeof forceShowAuth === 'function') {
                        forceShowAuth();
                    } else if (typeof showAuthScreen === 'function') {
                        showAuthScreen();
                    } else {
                        loadingScreen.classList.remove('active');
                        loadingScreen.style.display = 'none';
                        var authScreen = document.getElementById('auth-screen');
                        if (authScreen) {
                            authScreen.classList.add('active');
                            authScreen.style.display = 'block';
                        }
                    }
                }
            }, 1500);
        });
    </script>
</body>
</html>

